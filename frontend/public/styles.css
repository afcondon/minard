/* =============================================================================
   Code Explorer - Editorial Data Viz Theme

   "Data viz, not SaaS" - Minimalist print-inspired design with warm beige
   palette, monospace typography, and clean visual hierarchy.
   ============================================================================= */

/* =============================================================================
   CSS Variables - Editorial Palette
   ============================================================================= */

:root {
  /* Blueprint Theme - Technical Drawing Aesthetic */
  --color-blueprint-base: #082B5A;
  --color-blueprint-light: rgba(255, 255, 255, 0.9);
  --color-blueprint-white: #FFFFFF;
  --color-blueprint-grid: rgba(255, 255, 255, 0.15);

  /* Keep editorial colors for UI elements */
  --color-beige-base: #D4C9A8;
  --color-beige-light: #E8E0CC;
  --color-beige-dark: #C9B8A0;
  --color-red-accent: #E63946;
  --color-coral: #D97560;
  --color-peach: #E8B8A0;
  --color-teal: #5A8A8A;
  --color-line: #999999;
  --color-text-dark: #333333;
  --color-text-muted: #666666;
  --color-canvas: #0A0A1A;
  /* Blueprint background */
  --color-card: #F5F2E8;
  /* Light beige for cards and dropdowns */

  /* Typography */
  --font-mono: 'Fira Code', 'Courier New', 'Courier', Monaco, monospace;
  --font-size-tiny: 0.5rem;
  --font-size-small: 0.5625rem;
  --font-size-label: 0.6875rem;
  --font-size-body: 0.75rem;
  --letter-spacing-wide: 0.125rem;
  --letter-spacing-normal: 0.0625rem;

  /* Spacing */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;

  /* Transitions */
  --transition-fast: 150ms ease-in-out;
}

/* =============================================================================
   Reset & Base
   ============================================================================= */

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html,
body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: var(--font-mono);
  background: var(--color-canvas);
  color: var(--color-text-dark);
}

#app {
  width: 100%;
  height: 100%;
}

/* =============================================================================
   Full-Screen Visualization Canvas
   ============================================================================= */

.explorer-app {
  position: relative;
  width: 100%;
  height: 100%;
  background: var(--color-canvas);
}

#viz {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;
}

#viz svg {
  width: 100%;
  height: 100%;
  display: block;
}

/* =============================================================================
   Status Panel (Temporary - will be replaced by NarrativePanel)
   ============================================================================= */

.status-panel {
  position: fixed;
  top: var(--spacing-md);
  left: var(--spacing-md);
  background-color: rgba(212, 201, 168, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--color-line);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  padding: var(--spacing-md);
  z-index: 100;
  font-family: var(--font-mono);
  max-width: 300px;
}

.status-panel h2 {
  font-size: var(--font-size-label);
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-dark);
  margin: 0 0 var(--spacing-sm) 0;
  padding-bottom: var(--spacing-xs);
  border-bottom: 1px solid var(--color-line);
}

.status-panel p {
  font-size: var(--font-size-small);
  color: var(--color-text-muted);
  margin: var(--spacing-xs) 0;
}

/* =============================================================================
   Floating Control Panel - Editorial Style
   ============================================================================= */

.floating-panel {
  position: fixed;
  background-color: rgba(212, 201, 168, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--color-line);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  padding: var(--spacing-md);
  z-index: 100;
  font-family: var(--font-mono);
}

.floating-panel--top-left {
  top: var(--spacing-md);
  left: var(--spacing-md);
}

.floating-panel--top-right {
  top: var(--spacing-md);
  right: var(--spacing-md);
}

.floating-panel--bottom-left {
  bottom: var(--spacing-md);
  left: var(--spacing-md);
}

.floating-panel--bottom-right {
  bottom: var(--spacing-md);
  right: var(--spacing-md);
}

/* Panel Title */
.panel-title {
  font-family: var(--font-mono);
  font-size: var(--font-size-label);
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-dark);
  margin: 0 0 var(--spacing-md) 0;
  padding-bottom: var(--spacing-sm);
  border-bottom: 1px solid var(--color-line);
}

/* Section Headers */
.section-label {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-muted);
  margin: var(--spacing-md) 0 var(--spacing-xs) 0;
}

/* =============================================================================
   Editorial Buttons
   ============================================================================= */

.btn-editorial {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--color-line);
  background-color: transparent;
  color: var(--color-text-dark);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.btn-editorial:hover {
  background-color: var(--color-beige-light);
  border-color: var(--color-text-dark);
}

.btn-editorial--active,
.btn-editorial:active {
  background-color: var(--color-red-accent);
  border-color: var(--color-red-accent);
  color: white;
}

/* Button Group - connected buttons */
.btn-group {
  display: flex;
}

.btn-group .btn-editorial {
  margin: 0;
}

.btn-group .btn-editorial:not(:first-child) {
  border-left: none;
}

.btn-group .btn-editorial:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}

.btn-group .btn-editorial:last-child {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}

/* =============================================================================
   Editorial Select Dropdowns
   ============================================================================= */

.select-editorial {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  letter-spacing: var(--letter-spacing-normal);
  padding: var(--spacing-xs) var(--spacing-sm);
  border: 1px solid var(--color-line);
  background-color: transparent;
  color: var(--color-text-dark);
  cursor: pointer;
  min-width: 140px;
}

.select-editorial:focus {
  outline: none;
  border-color: var(--color-text-dark);
}

/* =============================================================================
   Control Groups
   ============================================================================= */

.control-row {
  display: flex;
  gap: var(--spacing-sm);
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: var(--spacing-sm);
}

.control-section {
  margin-bottom: var(--spacing-md);
}

/* Divider */
.divider {
  width: 1px;
  height: 24px;
  background-color: var(--color-line);
  margin: 0 var(--spacing-xs);
}

/* =============================================================================
   Info Text
   ============================================================================= */

.info-text {
  font-family: var(--font-mono);
  font-size: var(--font-size-tiny);
  letter-spacing: var(--letter-spacing-normal);
  line-height: 1.8;
  color: var(--color-text-muted);
}

/* Error message */
.error-message {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  color: var(--color-red-accent);
  padding: var(--spacing-sm);
  background: rgba(230, 57, 70, 0.1);
  border: 1px solid var(--color-red-accent);
}

/* =============================================================================
   Color Key / Legend Panel
   ============================================================================= */

.legend-panel {
  min-width: 160px;
}

.legend-items {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.legend-color {
  width: 14px;
  height: 14px;
  border: 1px solid var(--color-line);
  flex-shrink: 0;
}

.legend-label {
  font-family: var(--font-mono);
  font-size: var(--font-size-tiny);
  color: var(--color-text-dark);
  letter-spacing: var(--letter-spacing-normal);
}

/* =============================================================================
   Node Styles (Visualization)
   ============================================================================= */

.node circle {
  cursor: pointer;
}

.node text {
  pointer-events: none;
  fill: var(--color-text-dark);
  font-family: var(--font-mono);
  font-size: 9px;
  text-anchor: middle;
  dominant-baseline: middle;
  opacity: 0;
  transition: opacity 0.2s;
}

.node:hover text {
  opacity: 1;
}

/* =============================================================================
   Link Styles
   ============================================================================= */

.link {
  fill: none;
  stroke: var(--color-teal);
  stroke-opacity: 0.5;
  stroke-width: 1;
  transition: stroke 0.15s, stroke-opacity 0.15s, stroke-width 0.15s;
}

/* =============================================================================
   Highlight States
   ============================================================================= */

circle.highlighted-source {
  stroke: var(--color-red-accent) !important;
  stroke-width: 4px !important;
  filter: drop-shadow(0 0 6px rgba(230, 57, 70, 0.6));
}

circle.highlighted-upstream {
  stroke: var(--color-teal) !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 5px rgba(90, 138, 138, 0.6));
}

circle.highlighted-downstream {
  stroke: var(--color-coral) !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 5px rgba(217, 117, 96, 0.6));
}

.dimmed {
  opacity: 0.35 !important;
  transition: none !important;
}

.dimmed circle {
  filter: none !important;
}

.highlighted-link {
  stroke: var(--color-red-accent) !important;
  stroke-width: 2px !important;
  stroke-opacity: 0.8 !important;
}

.dimmed-link {
  stroke-opacity: 0.5 !important;
}

/* =============================================================================
   Scene-Specific Styles
   ============================================================================= */

.node {
  transition: none;
}

.tree-scene .package-node,
.tree-scene .non-tree-module {
  opacity: 0.06;
}

.tree-link {
  transition: opacity 0.5s ease-in-out;
}

/* =============================================================================
   Tooltip - Matches Floating Panel Style (v2)
   ============================================================================= */

.psd3-tooltip {
  position: fixed;
  z-index: 1000;
  /* Match floating panel background and blur */
  background-color: rgba(212, 201, 168, 0.95);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  /* Safari support */
  color: var(--color-text-dark);
  padding: var(--spacing-md);
  border: 1px solid var(--color-line);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  line-height: 1.6;
  max-width: 300px;
  pointer-events: none;
}

.tooltip-header {
  font-weight: bold;
  font-size: var(--font-size-label);
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-dark);
  margin-bottom: var(--spacing-sm);
  padding-bottom: var(--spacing-xs);
  border-bottom: 1px solid var(--color-line);
  word-break: break-all;
}

.tooltip-package {
  font-size: var(--font-size-tiny);
  color: var(--color-text-muted);
  letter-spacing: var(--letter-spacing-normal);
  margin-bottom: var(--spacing-sm);
  padding-bottom: var(--spacing-xs);
  border-bottom: 1px solid var(--color-line);
}

.tooltip-metrics {
  margin-top: var(--spacing-xs);
}

.tooltip-metric {
  display: flex;
  justify-content: space-between;
  margin-bottom: 2px;
  font-size: var(--font-size-tiny);
  letter-spacing: var(--letter-spacing-normal);
}

.metric-label {
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wide);
}

.metric-value {
  color: var(--color-text-dark);
  font-weight: bold;
  font-variant-numeric: tabular-nums;
}

/* =============================================================================
   Loading State
   ============================================================================= */

.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-family: var(--font-mono);
  font-size: var(--font-size-label);
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-muted);
}

/* =============================================================================
   Call Graph Highlighting (Declaration Hover)
   ============================================================================= */

/* Source module - the module containing the hovered declaration (cyan) */
g.module-pack.highlight-source {
  filter: drop-shadow(0 0 12px rgba(125, 211, 252, 0.8));
}

g.module-pack.highlight-source circle {
  stroke: #7dd3fc !important;
  stroke-width: 3px !important;
}

/* Caller modules - modules that call this function (orange) */
g.module-pack.highlight-caller {
  filter: drop-shadow(0 0 10px rgba(249, 115, 22, 0.7));
}

g.module-pack.highlight-caller circle {
  stroke: #f97316 !important;
  stroke-width: 2.5px !important;
}

/* Callee modules - modules this function calls (green) */
g.module-pack.highlight-callee {
  filter: drop-shadow(0 0 10px rgba(74, 222, 128, 0.7));
}

g.module-pack.highlight-callee circle {
  stroke: #4ade80 !important;
  stroke-width: 2.5px !important;
}

/* Dimmed modules - unrelated during call graph highlight */
g.module-pack.highlight-dimmed {
  opacity: 0.15;
}

g.module-pack.highlight-dimmed circle {
  filter: none !important;
}

/* Dimmed links during call graph highlight */
line.highlight-dimmed {
  opacity: 0.1 !important;
}

/* =============================================================================
   Function-Level Call Graph Highlighting
   ============================================================================= */

/* Source function - the hovered declaration (cyan glow) */
circle.fn-highlight-source {
  stroke: #7dd3fc !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 8px rgba(125, 211, 252, 0.9));
}

/* Caller functions - functions that call the source (orange) */
circle.fn-highlight-caller {
  stroke: #f97316 !important;
  stroke-width: 2.5px !important;
  filter: drop-shadow(0 0 6px rgba(249, 115, 22, 0.8));
}

/* Callee functions - functions the source calls (green) */
circle.fn-highlight-callee {
  stroke: #4ade80 !important;
  stroke-width: 2.5px !important;
  filter: drop-shadow(0 0 6px rgba(74, 222, 128, 0.8));
}

/* Dimmed circles and links - unrelated during function highlight */
circle.fn-highlight-dimmed {
  opacity: 0.2 !important;
  filter: none !important;
}

line.fn-highlight-dimmed {
  opacity: 0.08 !important;
}

/* Function edge lines - connecting source to callers/callees */
.fn-edge {
  pointer-events: none;
}

.fn-edge-caller {
  stroke: #f97316;
  stroke-width: 2px;
  stroke-opacity: 0.7;
}

.fn-edge-callee {
  stroke: #4ade80;
  stroke-width: 2px;
  stroke-opacity: 0.7;
}

/* =============================================================================
   Narrative Panel - "What Is Being Shown"
   ============================================================================= */

.narrative-panel {
  max-width: 320px;
  min-width: 280px;
}

/* Larger title for narrative panel */
.narrative-panel .panel-title {
  font-size: 0.875rem;
  /* 14px */
  letter-spacing: var(--letter-spacing-wide);
  margin-bottom: var(--spacing-lg);
}

.narrative-hero {
  font-family: var(--font-mono);
  font-size: 0.875rem;
  /* 14px - body text */
  line-height: 1.7;
  color: var(--color-text-dark);
  margin-bottom: var(--spacing-md);
}

.narrative-hero strong {
  color: var(--color-text-dark);
  font-weight: bold;
}

.narrative-module {
  color: var(--color-teal);
  font-weight: bold;
}

.narrative-path {
  font-size: 0.75rem;
  /* 12px */
  color: var(--color-text-muted);
}

.narrative-stat {
  font-weight: bold;
  font-variant-numeric: tabular-nums;
  padding: 0 2px;
}

.narrative-stat.narrative-callee {
  color: #16a34a;
  /* green-600 */
}

.narrative-stat.narrative-caller {
  color: #ea580c;
  /* orange-600 */
}

.narrative-hint {
  font-family: var(--font-mono);
  font-size: 0.75rem;
  /* 12px - subtext */
  line-height: 1.6;
  color: var(--color-text-muted);
  padding-top: var(--spacing-sm);
  border-top: 1px solid var(--color-line);
}

.narrative-hint em {
  font-style: normal;
  color: var(--color-text-dark);
  font-weight: bold;
}

.narrative-hint strong {
  color: var(--color-teal);
}

.narrative-nav {
  margin-top: var(--spacing-md);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.narrative-back {
  width: 100%;
  font-size: 0.75rem;
  padding: var(--spacing-sm) var(--spacing-md);
}

.narrative-back:hover:not(:disabled) {
  background-color: var(--color-beige-dark);
}

.narrative-back--disabled {
  opacity: 0.5;
  cursor: default;
  color: var(--color-text-muted);
}

.narrative-back--disabled:hover {
  background-color: transparent;
}

.narrative-project {
  width: 100%;
  font-size: 0.75rem;
  padding: var(--spacing-sm) var(--spacing-md);
  text-align: left;
}

.narrative-project:hover {
  background-color: var(--color-beige-dark);
}

.narrative-project::before {
  content: "Project: ";
  color: var(--color-text-muted);
  font-weight: normal;
}

/* =============================================================================
   View Icons (Overview Navigation)
   ============================================================================= */

.view-icons {
  display: flex;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-md);
}

.view-icon {
  width: 54px;
  height: 54px;
  padding: 2px;
  border: 1px solid var(--color-line);
  background: transparent;
  cursor: pointer;
  transition: all var(--transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.view-icon:hover {
  background: var(--color-beige-light);
  border-color: var(--color-text-dark);
}

.view-icon--active {
  border-color: var(--color-teal);
  border-width: 2px;
}

.view-icon-img {
  display: block;
  border-radius: 2px;
  object-fit: cover;
}

.narrative-project-wrapper {
  position: relative;
  width: 100%;
}

.project-dropdown {
  position: absolute;
  left: 0;
  right: 0;
  top: 100%;
  background: var(--color-card);
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  margin-top: var(--spacing-xs);
}

.project-dropdown-item {
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 0.75rem;
  cursor: pointer;
  transition: background-color 0.15s ease;
}

.project-dropdown-item:hover {
  background-color: var(--color-beige);
}

.project-dropdown-item--active {
  background-color: var(--color-beige-dark);
  font-weight: 600;
}

/* =============================================================================
   Module Search
   ============================================================================= */

.module-search-wrapper {
  position: relative;
  margin-top: var(--spacing-sm);
}

.module-search-input {
  width: 100%;
  padding: 6px 10px;
  font-family: var(--font-mono);
  font-size: var(--font-size-body);
  background-color: var(--color-beige-light);
  border: 1px solid var(--color-line);
  border-radius: 3px;
  color: var(--color-text-dark);
  outline: none;
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.module-search-input::placeholder {
  color: var(--color-text-muted);
  font-style: italic;
}

.module-search-input:focus {
  border-color: var(--color-teal);
  box-shadow: 0 0 0 2px rgba(90, 138, 138, 0.2);
}

.module-search-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background-color: var(--color-card);
  border: 1px solid var(--color-line);
  border-top: none;
  border-radius: 0 0 3px 3px;
  max-height: 240px;
  overflow-y: auto;
  z-index: 100;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.module-search-result {
  padding: 8px 10px;
  font-family: var(--font-mono);
  font-size: var(--font-size-body);
  color: var(--color-text-dark);
  cursor: pointer;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  transition: background-color var(--transition-fast);
}

.module-search-result:last-child {
  border-bottom: none;
}

.module-search-result:hover {
  background-color: var(--color-beige-base);
}

/* Keyboard-selected state (takes precedence over hover) */
.module-search-result--selected {
  background-color: var(--color-beige-light);
  outline: 2px solid var(--color-teal);
  outline-offset: -2px;
}

.module-search-result--selected:hover {
  background-color: var(--color-beige-light);
}

/* =============================================================================
   Header Search Overrides (compact input for header bar context)
   ============================================================================= */

.header-search-wrapper {
  position: relative;
  width: 200px;
}

.header-search-wrapper .module-search-input {
  height: 24px;
  padding: 2px 8px;
  font-size: 10px;
  background: rgba(255, 255, 255, 0.5);
  border-color: rgba(0, 0, 0, 0.2);
}

.header-search-wrapper .module-search-input:focus {
  background: rgba(255, 255, 255, 0.8);
}

.header-search-wrapper .module-search-dropdown {
  width: 380px;
  right: auto;
  font-size: 11px;
  z-index: 1000;
}

.header-search-wrapper .module-search-result {
  padding: 5px 8px;
}

/* =============================================================================
   Narrative Color Key
   ============================================================================= */

.narrative-color-key {
  margin-top: var(--spacing-md);
  padding-top: var(--spacing-md);
  border-top: 1px solid var(--color-line);
}

.color-key-title {
  font-family: var(--font-mono);
  font-size: 0.625rem;
  /* 10px */
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-muted);
  margin-bottom: var(--spacing-sm);
}

.color-key-items {
  display: flex;
  flex-direction: column;
  gap: 4px;
  max-height: 200px;
  /* ~12 items comfortably */
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--color-line) transparent;
}

.color-key-items::-webkit-scrollbar {
  width: 6px;
}

.color-key-items::-webkit-scrollbar-track {
  background: transparent;
}

.color-key-items::-webkit-scrollbar-thumb {
  background: var(--color-line);
  border-radius: 3px;
}

.color-key-items::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-light);
}

.color-key-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.color-key-swatch {
  width: 12px;
  height: 12px;
  border: 1px solid var(--color-line);
  flex-shrink: 0;
}

.color-key-label {
  font-family: var(--font-mono);
  font-size: 0.6875rem;
  /* 11px */
  color: var(--color-text-dark);
  letter-spacing: var(--letter-spacing-normal);
}

/* Simplified color key for concept-based legends */
.color-key-concept {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.color-key-concept-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.color-key-concept-label {
  font-family: var(--font-mono);
  font-size: 0.6875rem;
  color: var(--color-text-dark);
}

.color-key-concept-sublabel {
  font-family: var(--font-mono);
  font-size: 0.625rem;
  color: var(--color-text-light);
  font-style: italic;
}

.color-key-swatches {
  display: flex;
  gap: 3px;
}

.color-key-mini-swatch {
  display: inline-block;
  width: 14px;
  height: 14px;
  border-radius: 2px;
  flex-shrink: 0;
}

.color-key-samples {
  display: flex;
  gap: 4px;
  margin-top: 4px;
}

.color-key-sample {
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

/* =============================================================================
   TangleJS-style Interactive Controls
   ============================================================================= */

/* Clickable control - has options */
.tangle-control {
  color: var(--color-blue-accent, #2563eb);
  cursor: pointer;
  border-bottom: 1px dashed currentColor;
  transition: color 0.15s ease, border-color 0.15s ease;
}

.tangle-control:hover {
  color: var(--color-text-dark);
  border-bottom-style: solid;
}

/* Non-interactive highlighted value */
.tangle-value {
  color: var(--color-text-dark);
  font-weight: 500;
}

/* Dropdown for control options */
.tangle-dropdown {
  background: var(--color-beige, #f5f5dc);
  border: 1px solid var(--color-line, #ccc);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  min-width: 120px;
  font-family: var(--font-mono);
  font-size: 0.75rem;
}

.tangle-dropdown-item {
  padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
  cursor: pointer;
  transition: background-color 0.1s ease;
}

.tangle-dropdown-item:hover {
  background-color: var(--color-beige-dark, #e8e8d0);
}

.tangle-dropdown-item--active {
  font-weight: bold;
  color: var(--color-blue-accent, #2563eb);
}

.tangle-dropdown-item--active::before {
  content: "• ";
}

/* =============================================================================
   Treemap Styles
   ============================================================================= */

/* Package labels - semi-transparent by default */
.treemap-package-label {
  pointer-events: none;
  user-select: none;
}

/* Show all labels fully on treemap hover */
#treemap-group:hover .treemap-package-label {
  opacity: 1.0 !important;
  transition: opacity 0.2s ease;
}

/* Individual package rect hover effect — stroke handled by HATS highlight classes */

.treemap-module:hover {
  stroke: #111;
  stroke-width: 0.3;
  transition: stroke 0.15s ease, stroke-width 0.15s ease;
}

/* =============================================================================
   Watermark Treemap Styles
   ============================================================================= */

/* Watermark package rects - enable hover interaction */
.watermark-package {
  cursor: pointer;
}

/* Watermark labels - semi-transparent by default, full opacity on hover via JS */
.watermark-package-label {
  pointer-events: none;
  user-select: none;
}

/* =============================================================================
   Call Graph Popup
   ============================================================================= */

/* Overlay background */
.call-graph-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  z-index: 2000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-lg);
}

/* Popup content container */
.call-graph-content {
  background: var(--color-card);
  border: 2px solid var(--color-line);
  border-radius: 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  width: 90%;
  max-width: 1200px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  font-family: var(--font-mono);
}

/* Header with title and close button */
.call-graph-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  border-bottom: 2px solid var(--color-line);
  background: var(--color-beige-base);
}

.call-graph-header h3 {
  font-size: 0.875rem;
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-dark);
  margin: 0;
}

.call-graph-close {
  background: none;
  border: 2px solid var(--color-line);
  color: var(--color-text-dark);
  font-size: 1.5rem;
  font-weight: bold;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition-fast);
  line-height: 1;
  padding: 0;
}

.call-graph-close:hover {
  background: var(--color-beige-dark);
  border-color: var(--color-text-dark);
}

/* Body with three columns */
.call-graph-body {
  display: grid;
  grid-template-columns: 1fr 2fr 1fr;
  gap: 0;
  flex: 1;
  overflow: hidden;
}

.call-graph-column {
  display: flex;
  flex-direction: column;
  border-right: 2px solid var(--color-line);
  overflow: hidden;
}

.call-graph-column:last-child {
  border-right: none;
}

.call-graph-column h4 {
  font-size: 0.6875rem;
  font-weight: bold;
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  color: var(--color-text-muted);
  margin: 0;
  padding: var(--spacing-sm) var(--spacing-md);
  border-bottom: 1px solid var(--color-line);
  background: var(--color-beige-light);
}

/* Scrollable lists */
.call-graph-list {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-sm);
  font-size: 0.75rem;
  line-height: 1.6;
  scrollbar-width: thin;
  scrollbar-color: var(--color-line) transparent;
}

.call-graph-list::-webkit-scrollbar {
  width: 8px;
}

.call-graph-list::-webkit-scrollbar-track {
  background: transparent;
}

.call-graph-list::-webkit-scrollbar-thumb {
  background: var(--color-line);
  border-radius: 4px;
}

.call-graph-list::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

.call-graph-list-item {
  padding: var(--spacing-xs) var(--spacing-sm);
  margin-bottom: var(--spacing-xs);
  background: var(--color-beige-light);
  border-left: 3px solid var(--color-line);
  transition: var(--transition-fast);
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

.call-graph-list-item:hover {
  background: var(--color-beige-base);
  border-left-color: var(--color-red-accent);
}

/* Clickable links in caller/callee lists */
.call-graph-link {
  cursor: pointer;
  color: var(--color-blue-link);
  font-weight: 500;
}

.call-graph-link:hover {
  background: var(--color-blue-light) !important;
  border-left-color: var(--color-blue-link) !important;
  text-decoration: underline;
}

/* Git metrics section */
.call-graph-git-metrics {
  background: var(--color-beige-light);
  border: 1px solid var(--color-line);
  border-radius: var(--border-radius);
  padding: var(--spacing-sm);
  margin-bottom: var(--spacing-md);
  font-size: 0.75rem;
  line-height: 1.6;
}

.git-metric {
  margin-bottom: var(--spacing-xs);
}

.git-metric:last-child {
  margin-bottom: 0;
}

.git-metric strong {
  color: var(--color-text-primary);
  margin-right: var(--spacing-xs);
}

/* Source code with proper styling */
.call-graph-source {
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.6875rem;
  line-height: 1.8;
  white-space: pre-wrap;
  margin: 0;
  padding: var(--spacing-sm);
  background: #fafafa;
  border-radius: var(--border-radius);
}

/* Source code column - scrollable with monospace */
.call-graph-code {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-md);
  font-size: 0.6875rem;
  line-height: 1.8;
  white-space: pre-wrap;
  font-family: 'Courier New', Courier, monospace;
  background: #fafafa;
  scrollbar-width: thin;
  scrollbar-color: var(--color-line) transparent;
}

.call-graph-code::-webkit-scrollbar {
  width: 8px;
}

.call-graph-code::-webkit-scrollbar-track {
  background: transparent;
}

.call-graph-code::-webkit-scrollbar-thumb {
  background: var(--color-line);
  border-radius: 4px;
}

.call-graph-code::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

/* Loading and error states */
.call-graph-loading,
.call-graph-error,
.call-graph-empty {
  color: var(--color-text-muted);
  font-style: italic;
  padding: var(--spacing-md);
  text-align: center;
}

.call-graph-error {
  color: var(--color-red-accent);
}

/* =============================================================================
   Neighborhood View Type Toggles
   ============================================================================= */

.view-type-toggles {
  display: flex;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-sm);
  padding-top: var(--spacing-sm);
  border-top: 1px solid var(--color-line);
}

.view-type-toggle {
  width: 42px;
  height: 42px;
  padding: 2px;
  border: 1px solid var(--color-line);
  background: transparent;
  cursor: pointer;
  transition: all var(--transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.view-type-toggle:hover {
  background: var(--color-beige-light);
  border-color: var(--color-text-dark);
}

.view-type-toggle--active {
  background: var(--color-teal);
  border-color: var(--color-teal);
}

.view-type-toggle--active svg path,
.view-type-toggle--active svg circle,
.view-type-toggle--active svg line,
.view-type-toggle--active svg rect {
  stroke: white;
  fill: none;
}

.view-type-toggle svg {
  width: 20px;
  height: 20px;
}

.view-type-toggle svg path,
.view-type-toggle svg circle,
.view-type-toggle svg line,
.view-type-toggle svg rect {
  stroke: var(--color-text-dark);
  fill: none;
  stroke-width: 1.5;
}

/* Image-based toggle icons */
.view-type-toggle-img {
  display: block;
  border-radius: 2px;
  object-fit: cover;
}

.view-type-toggle--active .view-type-toggle-img {
  box-shadow: 0 0 0 2px var(--color-teal);
}

/* =============================================================================
   Chord Diagram Styles
   ============================================================================= */

#chord-diagram {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

#chord-diagram svg {
  width: 100%;
  height: 100%;
}

.chord-arc {
  pointer-events: all;
  cursor: pointer;
  transition: opacity var(--transition-fast);
}

.chord-arc:hover {
  opacity: 0.8;
}

.chord-ribbon {
  fill-opacity: 0.6;
  stroke: none;
  transition: fill-opacity var(--transition-fast);
}

.chord-ribbon:hover {
  fill-opacity: 0.9;
}

.chord-label {
  font-family: var(--font-mono);
  /* font-size: var(--font-size-small); */
  fill: var(--color-blueprint-light);
  pointer-events: none;
}

/* =============================================================================
   Treemap Highlight Styles
   ============================================================================= */

/* The hovered node - bright and prominent */
.module-node.highlighted {
  stroke: white !important;
  stroke-width: 3px !important;
  fill: rgba(255, 255, 255, 0.2) !important;
}

/* Nodes this module depends on (imports) - green tint */
.module-node.is-target {
  stroke: #4ade80 !important;
  stroke-width: 2px !important;
  fill: rgba(74, 222, 128, 0.15) !important;
}

/* Nodes that depend on this module (importers) - orange tint */
.module-node.is-source {
  stroke: #fb923c !important;
  stroke-width: 2px !important;
  fill: rgba(251, 146, 60, 0.15) !important;
}

/* All other nodes - dimmed (optional, currently unused) */
.module-node.dimmed {
  stroke: rgba(255, 255, 255, 0.15) !important;
  stroke-width: 0.5px !important;
  fill: rgba(14, 76, 138, 0.5) !important;
}

/* Package rect highlighting */
.package-rect.highlighted {
  stroke: white !important;
  stroke-width: 2px !important;
}

.package-rect.is-target {
  stroke: #4ade80 !important;
  stroke-width: 2px !important;
}

.package-rect.is-source {
  stroke: #fb923c !important;
  stroke-width: 2px !important;
}

/* =============================================================================
   View Switcher Buttons
   ============================================================================= */

/* =============================================================================
   Project Selector
   ============================================================================= */

.project-selector {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-sm);
  padding-bottom: var(--spacing-sm);
  border-bottom: 1px solid var(--color-line);
}

.project-selector label {
  font-size: var(--font-size-small);
  font-weight: bold;
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wide);
}

.project-selector select,
select.project-dropdown {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  padding: var(--spacing-xs) var(--spacing-sm);
  background: var(--color-beige-light);
  border: 1px solid var(--color-line);
  color: var(--color-text-dark);
  cursor: pointer;
  min-width: 160px;
}

.project-selector select:focus,
select.project-dropdown:focus {
  outline: none;
  border-color: var(--color-teal);
}

/* =============================================================================
   View Switcher Buttons
   ============================================================================= */

.view-switcher {
  display: flex;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-sm);
}

.view-switcher button {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  padding: var(--spacing-xs) var(--spacing-sm);
  background: var(--color-beige-light);
  border: 1px solid var(--color-line);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.view-switcher button:hover {
  background: var(--color-beige-dark);
}

.view-switcher button.active {
  background: var(--color-text-dark);
  color: var(--color-beige-light);
  border-color: var(--color-text-dark);
}

/* Scope selector (for package-level views) */
.scope-selector {
  display: flex;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-sm);
}

.scope-selector button {
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  padding: var(--spacing-xs) var(--spacing-sm);
  background: var(--color-beige-light);
  border: 1px solid var(--color-teal);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.scope-selector button:hover {
  background: var(--color-beige-dark);
}

.scope-selector button.active {
  background: var(--color-teal);
  color: var(--color-beige-light);
  border-color: var(--color-teal);
}

/* =============================================================================
   Tree View Elements
   ============================================================================= */

.tree-node {
  cursor: pointer;
}

.tree-link {
  pointer-events: none;
}

/* Tree view node states */
/* In-tree nodes: solid white at 0.5 opacity */
.module-node.in-tree {
  fill: rgba(255, 255, 255, 0.5) !important;
  stroke: rgba(255, 255, 255, 0.8) !important;
  stroke-width: 1.5px !important;
}

/* Dimmed nodes: faded but still visible */
.module-node.dimmed {
  stroke: rgba(255, 255, 255, 0.15) !important;
  stroke-width: 0.5px !important;
  fill: rgba(14, 76, 138, 0.3) !important;
  opacity: 0.4;
}

/* =============================================================================
   Synchronized Panel Hover Highlighting
   ============================================================================= */

/* Bubble Pack Highlighting */
.bubble-pack-node.bubble-highlighted {
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
}

.bubble-pack-node.bubble-highlighted circle {
  stroke: white !important;
  stroke-width: 3px !important;
}

.bubble-pack-node.bubble-dimmed {
  opacity: 0.3;
}

.bubble-link.bubble-dimmed {
  opacity: 0.15;
}

/* Chord Diagram Highlighting */
.chord-arc.chord-highlighted {
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
  stroke: white !important;
  stroke-width: 2px !important;
}

.chord-arc.chord-dimmed {
  opacity: 0.2;
}

.chord-ribbon.chord-connected {
  fill-opacity: 0.85 !important;
}

.chord-ribbon.chord-dimmed {
  opacity: 0.15;
}

/* Matrix Highlighting */
.matrix-cell.matrix-row-highlight,
.matrix-cell.matrix-col-highlight {
  fill-opacity: 0.9 !important;
  stroke: white !important;
  stroke-width: 1px !important;
}

.matrix-cell.matrix-highlighted {
  fill: #60a5fa !important;
  fill-opacity: 1 !important;
  stroke: white !important;
  stroke-width: 2px !important;
}

.matrix-cell.matrix-dimmed {
  opacity: 0.2;
}

.matrix-label.matrix-highlighted {
  fill: white !important;
  font-weight: bold;
}

.matrix-label.matrix-dimmed {
  opacity: 0.3;
}

/* =============================================================================
   Coordinated Highlighting (Generic Classes from PSD3)
   ============================================================================= */

/* Primary: The hovered element itself */
.bubble-pack-node.highlight-primary {
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
}

.bubble-pack-node.highlight-primary circle {
  stroke: white !important;
  stroke-width: 3px !important;
}

.chord-arc.highlight-primary {
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
  stroke: white !important;
  stroke-width: 2px !important;
}

.chord-ribbon.highlight-primary {
  fill-opacity: 0.9 !important;
}

.matrix-cell.highlight-primary {
  fill: #60a5fa !important;
  fill-opacity: 1 !important;
  stroke: white !important;
  stroke-width: 2px !important;
}

.matrix-label.highlight-primary {
  fill: white !important;
  font-weight: bold;
}

/* Related: Connected/related to the hovered element */
.chord-ribbon.highlight-related {
  fill-opacity: 0.85 !important;
}

.matrix-cell.highlight-related {
  fill-opacity: 0.9 !important;
  stroke: white !important;
  stroke-width: 1px !important;
}

/* Dimmed: Unrelated elements */
.bubble-pack-node.highlight-dimmed {
  opacity: 0.3;
}

.bubble-link.highlight-dimmed {
  opacity: 0.15;
}

.chord-arc.highlight-dimmed {
  opacity: 0.2;
}

.chord-ribbon.highlight-dimmed {
  opacity: 0.15;
}

.matrix-cell.highlight-dimmed {
  opacity: 0.2;
}

.matrix-label.highlight-dimmed {
  opacity: 0.3;
}

/* =============================================================================
   Module Treemap Hover Highlighting
   ============================================================================= */

/* Base treemap module styles with transitions */
.treemap-module {
  transition: opacity 0.15s ease-out;
}

.treemap-module rect {
  transition: fill 0.15s ease-out, stroke 0.15s ease-out, stroke-width 0.15s ease-out;
}

/* Primary: The hovered module - prominent border */
.treemap-module.highlight-primary rect {
  stroke: #2563eb !important;
  stroke-width: 3px !important;
  fill: #e0f2fe !important;
}

/* Related: Modules with import relationships - blue accent */
.treemap-module.highlight-related rect {
  stroke: #60a5fa !important;
  stroke-width: 2px !important;
  fill: #dbeafe !important;
}

/* Dimmed: Unrelated modules - faded */
.treemap-module.highlight-dimmed {
  opacity: 0.25;
}

.treemap-module.highlight-dimmed rect {
  fill: #e5e5e5 !important;
}

/* =============================================================================
   Galaxy Treemap Package Highlighting
   ============================================================================= */

/* Base package styles with transitions */
.treemap-package {
  transition: opacity 0.15s ease-out;
}

.treemap-package rect {
  transition: fill 0.15s ease-out, stroke 0.15s ease-out, stroke-width 0.15s ease-out;
}

.treemap-package circle {
  transition: fill 0.15s ease-out, stroke 0.15s ease-out, stroke-width 0.15s ease-out;
}

/* Ensure text labels stay white on blueprint theme during all highlight states */
.treemap-package text {
  fill: rgba(255, 255, 255, 0.5) !important;
  transition: fill 0.15s ease-out;
}

/* Highlight classes are on the cell content group (child of .treemap-package),
   not on .treemap-package itself — hover triggers only from circle/label area.
   CSS :has() propagates visual effects to sibling elements (rect, text). */

.treemap-package:has(.highlight-primary) text {
  fill: rgba(255, 255, 255, 0.95) !important;
}

.treemap-package:has(.highlight-related) text {
  fill: rgba(255, 255, 255, 0.8) !important;
}

.treemap-package:has(.highlight-dimmed) text {
  fill: rgba(255, 255, 255, 0.2) !important;
}

/* Primary: The hovered package - bright stroke for visibility on dark theme */
.treemap-package:has(.highlight-primary) rect {
  stroke: #ffc040 !important;
  stroke-width: 2px !important;
}

.treemap-package:has(.highlight-primary) circle {
  fill: #ffc040 !important;
  stroke: #fff !important;
  stroke-width: 2px !important;
}

/* Related: Packages with dependency relationships - blue accent (generic fallback) */
.treemap-package:has(.highlight-related) rect {
  stroke: #60a5fa !important;
  stroke-width: 1.5px !important;
}

.treemap-package:has(.highlight-related) circle {
  fill: #60a5fa !important;
  stroke: #fff !important;
  stroke-width: 1px !important;
}

/* Upstream: Dependencies (things the hovered package depends on) - green */
.treemap-package:has(.highlight-upstream) rect {
  stroke: #22c55e !important;
  stroke-width: 1.5px !important;
}

.treemap-package:has(.highlight-upstream) circle {
  fill: #22c55e !important;
  stroke: #fff !important;
  stroke-width: 1px !important;
}

.treemap-package:has(.highlight-upstream) text {
  fill: rgba(255, 255, 255, 0.9) !important;
}

/* Downstream: Dependents (things that depend on hovered package) - orange */
.treemap-package:has(.highlight-downstream) rect {
  stroke: #f97316 !important;
  stroke-width: 1.5px !important;
}

.treemap-package:has(.highlight-downstream) circle {
  fill: #f97316 !important;
  stroke: #fff !important;
  stroke-width: 1px !important;
}

.treemap-package:has(.highlight-downstream) text {
  fill: rgba(255, 255, 255, 0.9) !important;
}

/* Dimmed: Unrelated packages - faded */
.treemap-package:has(.highlight-dimmed) {
  opacity: 0.15;
}

.treemap-package:has(.highlight-dimmed) rect {
  fill: #1a2a4a !important;
}

.treemap-package:has(.highlight-dimmed) circle {
  fill: #3a4a6a !important;
}

/* Rect hover affordance - subtle lightening on dark midnight theme */
.treemap-package .package-rect:hover {
  fill: rgba(255, 255, 255, 0.06) !important;
  stroke: rgba(255, 255, 255, 0.8) !important;
  stroke-width: 1.5px !important;
  cursor: pointer;
}

/* =============================================================================
   Module Treemap Enriched Rect Hover Affordance
   ============================================================================= */

/* Subtle lightening on steel/blueprint background */
.treemap-module-enriched:hover .module-rect {
  fill: rgba(255, 255, 255, 0.08) !important;
  stroke: rgba(255, 255, 255, 0.6) !important;
  stroke-width: 1.5px !important;
}

/* =============================================================================
   Declaration Treemap Highlighting (ModuleOverview left panel)
   ============================================================================= */

/* Base transitions */
.treemap-declaration {
  transition: opacity 0.15s ease-out;
}

.treemap-declaration rect {
  transition: fill 0.15s ease-out, stroke 0.15s ease-out, stroke-width 0.15s ease-out;
}

/* Rect hover affordance */
.treemap-declaration .declaration-rect:hover {
  stroke: rgba(255, 255, 255, 0.5) !important;
  stroke-width: 1.5px !important;
}

/* Primary: The hovered declaration - blue border */
.treemap-declaration.highlight-primary .declaration-rect {
  stroke: #2563eb !important;
  stroke-width: 2px !important;
}

.treemap-declaration.highlight-primary .declaration-strip {
  opacity: 1 !important;
}

/* Related: Declarations with call relationships - amber border */
.treemap-declaration.highlight-related .declaration-rect {
  stroke: #f59e0b !important;
  stroke-width: 1.5px !important;
}

/* Dimmed: Unrelated declarations - faded */
.treemap-declaration.highlight-dimmed {
  opacity: 0.25;
}

/* Dependency links - glow when related */
.dependency-link.highlight-related {
  stroke-opacity: 0.8 !important;
  stroke-width: 1.5px !important;
}

.dependency-link.highlight-dimmed {
  stroke-opacity: 0.05 !important;
}

/* =============================================================================
   Package Set Swarm Highlighting (Beeswarm View)
   Note: Highlight classes are applied to .package-group (the <g> element),
   so selectors target .package-group.highlight-* .package-circle
   ============================================================================= */

/* Primary: The hovered package - white stroke for visibility */
.package-group.highlight-primary .package-circle {
  stroke: #fff !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
}

/* Related: Generic related highlight (fallback) - white stroke with blue glow */
.package-group.highlight-related .package-circle {
  stroke: #fff !important;
  stroke-width: 2.5px !important;
  filter: drop-shadow(0 0 6px rgba(33, 150, 243, 0.7));
}

/* Upstream: Dependencies of hovered - white stroke with green glow */
.package-group.highlight-upstream .package-circle {
  stroke: #fff !important;
  stroke-width: 2.5px !important;
  filter: drop-shadow(0 0 6px rgba(34, 197, 94, 0.7));
}

/* Downstream: Dependents of hovered - white stroke with blue glow */
.package-group.highlight-downstream .package-circle {
  stroke: #fff !important;
  stroke-width: 2.5px !important;
  filter: drop-shadow(0 0 6px rgba(59, 130, 246, 0.7));
}

/* Dimmed: Unrelated packages - reduced opacity */
.package-group.highlight-dimmed .package-circle {
  opacity: 0.2 !important;
  filter: none !important;
}

/* Package labels - hidden by default, shown on highlight */
.package-group .package-label {
  opacity: 0;
  transition: opacity 0.15s ease-in-out;
}

/* Show label for highlighted packages (primary, upstream, downstream) */
.package-group.highlight-primary .package-label,
.package-group.highlight-upstream .package-label,
.package-group.highlight-downstream .package-label {
  opacity: 1;
}

/* Hide label for dimmed packages */
.package-group.highlight-dimmed .package-label {
  opacity: 0;
}

/* =============================================================================
   Declaration Circle Highlighting (Enriched Module Treemap)
   ============================================================================= */

/* Base declaration circle styles with transitions */
.declaration-circle {
  transition: opacity 0.15s ease-out, stroke 0.15s ease-out, stroke-width 0.15s ease-out, transform 0.15s ease-out;
}

/* Primary: The hovered declaration */
.declaration-circle.highlight-primary {
  stroke: #fbbf24 !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.5));
}

/* Related: Declarations that call or are called by the hovered one */
.declaration-circle.highlight-related {
  stroke: #60a5fa !important;
  stroke-width: 2px !important;
  opacity: 1 !important;
}

/* Dimmed: Unrelated declarations */
.declaration-circle.highlight-dimmed {
  opacity: 0.15 !important;
}

/* -----------------------------------------------------------------------------
   Dependency Links - Curved paths connecting related declarations
   ----------------------------------------------------------------------------- */

/* Base dependency link styles */
.dependency-link {
  transition: stroke 0.15s ease-out, stroke-width 0.15s ease-out, stroke-opacity 0.15s ease-out;
}

/* Related: Links connected to the hovered declaration - full brightness */
.dependency-link.highlight-related {
  stroke: #f59e0b !important;  /* Amber-500 */
  stroke-width: 1.5px !important;
  stroke-opacity: 1 !important;
}

/* Upstream: Link to a dependency of the hovered package - green */
.dependency-link.highlight-upstream {
  stroke: #22c55e !important;  /* Green-500 */
  stroke-width: 1.5px !important;
  stroke-opacity: 1 !important;
}

/* Downstream: Link from a dependent of the hovered package - orange */
.dependency-link.highlight-downstream {
  stroke: #f97316 !important;  /* Orange-500 */
  stroke-width: 1.5px !important;
  stroke-opacity: 1 !important;
}

/* Dimmed: Unrelated links - fade to near invisible */
.dependency-link.highlight-dimmed {
  stroke-opacity: 0 !important;
}

/* -----------------------------------------------------------------------------
   Module Circle Highlighting (BubblePackBeeswarm)
   ----------------------------------------------------------------------------- */

.module-circle-group {
  transition: opacity 0.15s ease-out;
}

.module-circle-group.highlight-primary .module-circle {
  stroke: #fbbf24 !important;
  stroke-width: 2px !important;
}

.module-circle-group.highlight-related .module-circle {
  stroke: #f59e0b !important;
  stroke-width: 1.5px !important;
  fill-opacity: 0.9 !important;
}

.module-circle-group.highlight-dimmed {
  opacity: 0.15;
}

/* =============================================================================
   Package Overview Layout (Beeswarm/CirclePack with Auxiliary Panels)
   ============================================================================= */

.package-overview-layout {
  display: flex;
  width: 100%;
  height: 100%;
  gap: var(--spacing-sm);
}

.package-overview-layout .main-panel {
  flex: 2;
  min-width: 0;
  height: 100%;
  overflow: hidden;
}

.package-overview-layout .auxiliary-panels {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  min-width: 320px;
  max-width: 420px;
  height: 100%;
  overflow: hidden;
}

.package-overview-layout .chord-viz,
.package-overview-layout .matrix-viz {
  flex: 1;
  min-height: 0;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  overflow: hidden;
}

.package-overview-layout .chord-viz svg,
.package-overview-layout .matrix-viz svg {
  width: 100%;
  height: 100%;
}

/* =============================================================================
   Treemap Controls (Visualization Parameter Panel)
   ============================================================================= */

.treemap-container {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.treemap-controls {
  position: absolute;
  top: var(--spacing-md);
  right: var(--spacing-md);
  z-index: 100;
  background-color: rgba(212, 201, 168, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--color-line);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  padding: var(--spacing-sm) var(--spacing-md);
  font-family: var(--font-mono);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.treemap-controls .control-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.treemap-controls .control-label {
  font-size: var(--font-size-small);
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wide);
  color: var(--color-text-muted);
  min-width: 45px;
}

.treemap-controls .control-btn {
  font-family: var(--font-mono);
  font-size: var(--font-size-tiny);
  font-weight: bold;
  letter-spacing: var(--letter-spacing-normal);
  text-transform: uppercase;
  padding: var(--spacing-xs) var(--spacing-sm);
  border: 1px solid var(--color-line);
  background-color: transparent;
  color: var(--color-text-dark);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.treemap-controls .control-btn:hover {
  background-color: var(--color-beige-light);
  border-color: var(--color-text-dark);
}

.treemap-controls .control-btn.active {
  background-color: var(--color-teal);
  border-color: var(--color-teal);
  color: white;
}

/* Connected button group */
.treemap-controls .control-group .control-btn:not(:first-of-type) {
  border-left: none;
}

#treemap-viz {
  flex: 1;
  width: 100%;
  height: 100%;
}

/* =============================================================================
   CSS-Based Tooltips (data-tooltip attribute)
   ============================================================================= */

/* Elements with data-tooltip show tooltip on hover */
[data-tooltip] {
  position: relative;
  cursor: pointer;
}

/* Tooltip content via ::after pseudo-element */
[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  z-index: 2000;
  left: 50%;
  bottom: calc(100% + 8px);
  transform: translateX(-50%);

  /* Match floating panel style */
  background-color: rgba(212, 201, 168, 0.98);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  color: var(--color-text-dark);
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--color-line);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);

  /* Typography */
  font-family: var(--font-mono);
  font-size: var(--font-size-small);
  line-height: 1.5;
  white-space: pre-line;
  text-align: left;
  max-width: 320px;
  min-width: 150px;

  /* Initially hidden */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity 0.15s ease-in-out, visibility 0.15s ease-in-out;
}

/* Show tooltip on hover */
[data-tooltip]:hover::after {
  opacity: 1;
  visibility: visible;
}

/* Arrow pointing down */
[data-tooltip]::before {
  content: '';
  position: absolute;
  z-index: 2001;
  left: 50%;
  bottom: calc(100% + 2px);
  transform: translateX(-50%);

  border-width: 6px;
  border-style: solid;
  border-color: rgba(212, 201, 168, 0.98) transparent transparent transparent;

  /* Initially hidden */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity 0.15s ease-in-out, visibility 0.15s ease-in-out;
}

/* Show arrow on hover */
[data-tooltip]:hover::before {
  opacity: 1;
  visibility: visible;
}

/* For SVG elements, tooltip positioned based on element center */
/* BubblePack beeswarm label backgrounds — hidden until hover */
.package-bubble .label-bg {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
}
.package-bubble:hover .label-bg {
  opacity: 1;
}

svg [data-tooltip]::after {
  left: 50%;
  bottom: auto;
  top: -12px;
  transform: translate(-50%, -100%);
}

svg [data-tooltip]::before {
  left: 50%;
  bottom: auto;
  top: -6px;
  transform: translate(-50%, -100%);
}

/* =============================================================================
   Dependency Neighborhood Overlay (DeclarationDetail left panel)
   ============================================================================= */

.neighborhood-node circle {
  transition: opacity 0.2s ease, stroke-width 0.2s ease;
}

.neighborhood-node:hover circle {
  stroke-width: 2.5px;
  filter: brightness(1.2);
}

.neighborhood-link {
  transition: opacity 0.2s ease;
}

.neighborhood-node text {
  pointer-events: none;
}

/* =============================================================================
   SigMap Sparkline Cells
   ============================================================================= */

.sigmap-cell {
  position: relative;
}

/* Fixed-position tooltip for full-size signature on hover */
.sigmap-tooltip {
  display: none;
  position: fixed;
  z-index: 9999;
  background: #fff;
  border: 1px solid #d0d0d0;
  border-radius: 6px;
  padding: 12px 16px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.2);
  pointer-events: none;
  white-space: nowrap;
  width: max-content;
  max-width: 90vw;
}

.sigmap-cell-sparkline:hover {
  z-index: 100;
}

/* =============================================================================
   Sigil HTML Rendering (type signatures as native HTML)
   ============================================================================= */

/* ── Swiss Typographic Signature Layout ──
   Four-layer information hierarchy:
     WHAT        → <dfn> identifier name (darkest, boldest)
     HOW         → body: arrow chain, types (indented with left rule)
     UNDERSTAND  → constraints (right-aligned, annotation tone)
     ANNOTATION  → ∀ quantifier (left-aligned, annotation tone)

   Layout:
     ┌────────────────────────────────────────┐
     │ ∀ vars .              Constraint₁      │  preamble
     │                       Constraint₂      │
     │ name ::                                │  declaration
     │  │ from → to → result                  │  body
     └────────────────────────────────────────┘

   Elements: <code> wrapper, <dfn> name, <var> type variables,
   <ol>/<li> arrow chains, <dl>/<dt>/<dd> records, <em> constraints,
   <small> decorative punctuation (::, →, ., parens).
   Visual appearance is CSS-only. */

/* Full-size wrapper (<code>) */
.sig-full { font-family: var(--font-mono); font-size: 13px; line-height: 1.5;
            display: block; font-style: normal; }
/* Fitted variant: shrink-wrap so constraints stay close (for standalone/tooltips) */
.sig-fitted { width: fit-content; }
.sigmap-tooltip .sig-full { width: fit-content; }

/* ── Preamble: quantifier (left) · · · constraints (right) ── */
.sig-preamble { display: flex; align-items: flex-end; margin-bottom: 1px; }

/* Quantifier (∀ vars .) */
.sig-quant { flex-shrink: 0; display: flex; align-items: baseline; gap: 4px; font-size: 12px; }
.sig-quant-sym { color: #8b7355; font-weight: 700; font-size: inherit; }
.sig-quant-dot { color: #8b7355; font-weight: 600; font-size: inherit; }

/* Dot leader between quantifier and constraints */
.sig-leader { flex: 1; border-bottom: 1px dotted #d0ccc4; margin: 0 10px;
              align-self: flex-end; margin-bottom: 4px; min-width: 12px; }

/* Constraints (right-stacked) */
.sig-ctx { flex-shrink: 0; display: flex; flex-direction: column; align-items: flex-end;
           gap: 1px; margin-left: auto; }
.sig-ctx-item { display: inline-flex; align-items: baseline; gap: 4px;
                font-size: 12px; font-style: normal; white-space: nowrap; }
.sig-ctx-class { color: #8b7355; font-weight: 600; }

/* ── Declaration: name :: ── */
.sig-decl { display: flex; align-items: baseline; gap: 0.4em; }
.sig-name { color: #1a1a1a; font-weight: 700; font-style: normal; }
.sig-dcolon { color: #999; font-size: inherit; }
.sig-sep { color: #888; font-size: inherit; }

/* ── Body: type content with left rule ── */
.sig-body { display: flex; flex-direction: column; gap: 2px;
            border-left: 2px solid #d0ccc4; padding-left: 12px; margin-left: 4px;
            margin-top: 2px; }

/* Nested constrained (inside body, for rank-N etc.) */
.sig-constrained { display: flex; flex-direction: column; gap: 2px; }

/* Arrow chain (<ol> with CSS-generated → separators) */
.sig-arrow-chain { display: inline-flex; flex-wrap: wrap; align-items: center; gap: 2px;
                   list-style: none; margin: 0; padding: 0; }
.sig-arrow-chain > li { display: inline-flex; align-items: center; }
.sig-arrow-chain > li + li::before { content: "\2192"; color: #71717a; padding: 0 5px;
                                     font-style: normal; font-weight: 600;
                                     font-size: 1.15em; }

/* Type variable (<var>) — colored text via --vc custom property */
.sig-var { color: var(--vc, #0369a1); font-weight: 600; font-style: italic;
           font-size: 0.92em; }
.sig-var.sig-wildcard { --vc: #71717a; }

/* Type constructor (<code>) */
.sig-con { color: #16653e; font-weight: 600; }
.sig-con-effect { color: #9333ea; }

/* Application (<code>) */
.sig-app { display: inline-flex; align-items: center; gap: 5px; }
.sig-hkt { background: #f8f8f6; border: 1px solid #d0d0d0; border-radius: 3px; padding: 2px 5px; }

/* Nested constraints (inline, for body-level/rank-N constraints) */
.sig-constraints { display: flex; flex-direction: column; gap: 2px; margin-bottom: 4px; }
.sig-constraint { display: inline-flex; align-items: center; gap: 3px;
                  background: #fef3c7; border: 1px solid #d97706; border-radius: 3px;
                  padding: 1px 8px; font-size: 11px; color: #92400e; font-weight: 600;
                  font-style: normal; }

/* Nested forall (inline, for rank-N types) */
.sig-forall { display: flex; flex-direction: column; gap: 2px; }
.sig-forall-row { display: flex; align-items: center; gap: 3px; }
.sig-forall-symbol { color: #7b61ff; font-weight: 700; font-size: inherit; }
.sig-forall-dot { color: #7b61ff; font-weight: 600; font-size: inherit; }

/* Parens (<small>) */
.sig-paren { color: #aaa; font-size: inherit; }

/* Record / Row — 3-column grid: name | :: | type */
.sig-record { display: grid; grid-template-columns: auto auto 1fr; gap: 0 6px;
              border: 1px solid #ccc; border-radius: 4px; background: white;
              padding: 2px 8px; font-size: 12px; width: fit-content; }
.sig-record-open { border-style: dashed; border-width: 1.5px; }
.sig-record > dt { color: #333; font-weight: 600; font-style: normal; }
.sig-record > dd { margin: 0; }
.sig-field-sep { color: #aaa; font-weight: normal; white-space: nowrap; }
.sig-field-type { color: #555; }
.sig-row-tail { margin: 0; }
/* Row separator lines (every row after the first = children 4+) */
.sig-record > :nth-child(n+4) { border-top: 1px solid #f0f0f0; padding-top: 2px; }

/* Row combination (single-column table of + operands) */
.sig-row-combo { display: flex; flex-direction: column;
                 border: 1px solid #ccc; border-radius: 4px; background: white;
                 padding: 2px 8px; font-size: 12px; list-style: none; margin: 0;
                 width: fit-content; }
.sig-row-combo > li { padding: 2px 0; display: flex; align-items: center; gap: 4px; }
.sig-row-combo > li + li { border-top: 1px solid #f0f0f0; }

/* String literals */
.sig-string { color: #6b4226; font-weight: 600; }

/* Operator */
.sig-op { color: #71717a; font-weight: 600; padding: 0 3px; font-size: inherit; }

/* Sigil body-only (compact inline rendering in value cells) */
.sig-body-only { font-size: 12px; line-height: 1.4; width: fit-content; max-width: 100%; }

/* ── Siglet (miniature indicators) ── */
.sig-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; vertical-align: middle;
           font-size: 0; overflow: hidden; padding: 0; }
.sig-dot-con { border: 1.5px solid #16653e; background: none; }
.sig-dot-head { width: 11px; height: 11px; }
.sig-dot-effect { background: #9333ea; border: none; }
.sig-dot.sig-wildcard { background: #71717a; }

.sig-siglet { display: inline-flex; flex-direction: column; gap: 1px; margin-top: 2px;
              font-style: normal; }
/* Siglet: constrained type variables get pill style */
.sig-siglet .sig-var-pill { display: inline-block; background: var(--vc, #0369a1); color: white;
                            padding: 1px 5px; border-radius: 3px; }

/* Siglet record/row: { ○ ○ ○ } or { ○ ○ ○ |r } */
.sig-record-mini { display: inline-flex; align-items: center; gap: 2px; }
.sig-brace { color: #999; font-weight: 600; font-size: inherit; }
.sig-pipe { color: #999; font-weight: 600; font-size: inherit; }

/* =============================================================================
   ADT (data/newtype declaration) HTML rendering
   ============================================================================= */

.sig-adt { font-family: var(--font-mono); font-size: 13px; line-height: 1.5;
           width: fit-content; min-width: 180px; }

/* Header bar: amber background */
.sig-adt-header { display: flex; align-items: baseline; gap: 5px;
                  background: #fef3c7; border: 1px solid #d97706; border-radius: 4px;
                  padding: 4px 10px; }
.sig-adt-name { color: #92400e; font-weight: 700; font-style: normal; }

/* Keyword (shared between ADT and class) */
.sig-kw { color: #7b61ff; font-weight: 600; font-size: 12px; }

/* Constructor list: rail drawn per-item so it terminates at the last dot */
.sig-adt-ctors { list-style: none; margin: 0; padding: 8px 0 4px 0;
                 margin-left: 16px; }

.sig-adt-ctor { position: relative; display: flex; align-items: baseline; gap: 6px;
                padding: 2px 0 2px 24px; min-height: 24px;
                border-left: 2px solid #d97706; }

/* Last item: rail stops at the dot (50%) */
.sig-adt-ctor:last-child {
  border-image: linear-gradient(to bottom, #d97706 50%, transparent 50%) 1;
}
/* Single constructor: no rail */
.sig-adt-ctor:only-child { border-left-color: transparent; border-image: none; }

/* Branch stub: horizontal line from rail center */
.sig-adt-ctor::before { content: ""; position: absolute; left: -1px; top: 50%;
                        width: 17px; height: 0; border-top: 2px solid #d97706; }

/* Junction dot centered on rail */
.sig-adt-ctor::after { content: ""; position: absolute; left: -1px; top: 50%;
                       width: 6px; height: 6px; border-radius: 50%; background: white;
                       border: 1.5px solid #d97706; transform: translate(-50%, -50%); }

.sig-adt-ctor-name { color: #b45309; font-weight: 700; font-style: normal; }
.sig-adt-ctor-args { display: inline-flex; align-items: center; gap: 5px; }
.sig-adt-ctor-dash { color: #ddd; font-size: 10px; }

/* Opaque type indicator */
.sig-adt-opaque-label { display: flex; justify-content: center; padding: 8px 0 4px;
                        color: #bbb; font-size: 11px; font-style: italic; }

/* =============================================================================
   Type class definition HTML rendering
   ============================================================================= */

.sig-class { font-family: var(--font-mono); font-size: 13px; line-height: 1.5;
             width: fit-content; min-width: 200px; }

/* Header bar: indigo background */
.sig-class-header { display: flex; align-items: baseline; gap: 5px;
                    background: #f0f4ff; border: 1px solid #6366f1; border-radius: 4px;
                    padding: 4px 10px; }
.sig-class-name { color: #4338ca; font-weight: 700; font-style: normal; }

/* Superclass row: right-justified above header (like constraints above signatures) */
.sig-class-supers { display: flex; align-items: baseline; justify-content: flex-end;
                    gap: 4px; padding: 0 4px 2px 0; font-size: 11px; }
.sig-class-arrow { color: #d97706; font-size: 12px; }
.sig-class-comma { color: #aaa; }
.sig-class-super { color: #92400e; font-weight: 600; font-style: normal; }

/* Methods container */
.sig-class-methods { padding: 4px 0 4px 12px; }
.sig-class-no-methods { color: #aaa; font-size: 11px; }
.sig-class-empty { font-style: italic; }

/* Single method entry */
.sig-method { padding: 4px 0; }
.sig-method + .sig-method { border-top: 1px solid #e8e8f0; }
.sig-method-constraints { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 2px; }
.sig-method-decl { display: flex; align-items: baseline; flex-wrap: wrap; gap: 0; }
.sig-method-name { color: #1a1a1a; font-weight: 700; font-style: normal; }
.sig-method-sep { color: #aaa; font-size: inherit; white-space: pre; }
.sig-method-forall { display: flex; align-items: center; gap: 3px;
                     font-size: 12px; margin-top: 2px; }

/* Inherited methods section */
.sig-class-inherited { border-top: 1px dashed #d4d4d8; margin-top: 4px; padding-top: 4px; }
.sig-class-via-group { padding: 2px 0 2px 12px; }
.sig-class-via { font-size: 10px; font-weight: 600; font-style: italic;
                 color: #92400e; padding: 2px 0; }

/* Inherited methods rendered slightly muted */
.sig-class-inherited .sig-method { opacity: 0.7; }

/* Instances section */
.sig-class-instances { border-top: 1px dashed #c7d2fe; margin-top: 6px; padding-top: 4px; }
.sig-class-instances-header { font-size: 10px; font-weight: 600; color: #6366f1;
                              letter-spacing: 0.3px; padding: 2px 0 4px; }
.sig-class-instance-list { list-style: none; margin: 0; padding: 0;
                           display: flex; flex-wrap: wrap; gap: 3px; }
.sig-class-instance { display: inline; }
.sig-class-instance-name { font-family: 'Fira Code', 'SF Mono', monospace;
                           font-size: 10px; color: #4338ca;
                           background: #eef2ff; border: 1px solid #c7d2fe;
                           border-radius: 3px; padding: 1px 5px; }

/* =============================================================================
   Type synonym (type alias) HTML rendering
   ============================================================================= */

.sig-type-alias { font-family: var(--font-mono); font-size: 13px; line-height: 1.5;
                  width: fit-content; min-width: 140px; }

/* Header bar: gold/yellow background */
.sig-type-alias-header { display: flex; align-items: baseline; gap: 5px;
                         background: #fdf9ec; border: 1px solid #edc948; border-radius: 4px;
                         padding: 4px 10px; }
.sig-type-alias-name { color: #92700e; font-weight: 700; font-style: normal; }

/* Body: = expansion */
.sig-type-alias-body { display: flex; flex-direction: column; gap: 2px;
                       padding: 4px 0 2px 12px; }
.sig-type-alias-eq { color: #71717a; font-weight: 600; font-size: inherit;
                     margin-right: 6px; }

/* =============================================================================
   Foreign import HTML rendering
   ============================================================================= */

.sig-foreign { font-family: var(--font-mono); font-size: 13px; line-height: 1.5;
               width: fit-content; min-width: 140px; }

/* Header bar: rose/red background */
.sig-foreign-header { display: flex; align-items: baseline; gap: 5px;
                      background: #fdf0f0; border: 1px solid #e15759; border-radius: 4px;
                      padding: 4px 10px; }
.sig-foreign-name { color: #9b2c2c; font-weight: 700; font-style: normal; }

/* Body: type expression */
.sig-foreign-body { display: flex; flex-direction: column; gap: 2px;
                    border-left: 2px solid #d0ccc4; padding-left: 12px; margin-left: 4px;
                    margin-top: 2px; }

/* =============================================================================
   PureScript Source Code Syntax Highlighting
   ============================================================================= */

.ps-source {
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.7;
  background: #faf9f7;
  border: 1px solid #e8e6e0;
  border-radius: 4px;
  overflow: auto;
  padding: 8px 0;
}

.ps-line {
  display: flex;
  min-height: 1.7em;
  padding: 0 12px 0 0;
}

.ps-linenum {
  width: 3.5em;
  text-align: right;
  padding-right: 1em;
  color: #c0bdb8;
  user-select: none;
  font-variant-numeric: tabular-nums;
  flex-shrink: 0;
}

.ps-code {
  flex: 1;
  white-space: pre;
}

/* Focused declaration highlight */
.ps-focused {
  background: rgba(14, 76, 138, 0.04);
}

.ps-focused-accent {
  border-left: 3px solid;
  /* border-left-color set via inline style from kindColor */
  margin-right: 4px;
  flex-shrink: 0;
}

/* Token classes - restrained, print-inspired palette */
.ps-keyword {
  color: #1a1a2e;
  font-weight: 600;
}

.ps-type {
  color: #0E4C8A;
}

.ps-ident {
  color: #333;
}

.ps-operator {
  color: #8b7355;
}

.ps-string {
  color: #6b4226;
}

.ps-number {
  color: #6b4226;
}

.ps-comment {
  color: #a09a90;
  font-style: italic;
}

.ps-module {
  color: #888;
}

.ps-punct {
  color: #999;
}

/* Clickable identifiers */
a.ps-clickable {
  color: inherit;
  text-decoration: none;
  border-bottom: 1px dotted currentColor;
  cursor: pointer;
}

a.ps-clickable:hover {
  color: #0E4C8A;
  border-bottom-style: solid;
  background: rgba(14, 76, 138, 0.06);
}